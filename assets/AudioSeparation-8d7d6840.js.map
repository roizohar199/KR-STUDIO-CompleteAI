{"version":3,"file":"AudioSeparation-8d7d6840.js","sources":["../../src/api/client.js","../../src/components/audio-separation/TrackChannel.jsx","../../src/components/audio-separation/ProjectCard.jsx","../../src/components/audio-separation/EmptyState.jsx","../../src/components/audio-separation/UploadZone.jsx","../../src/components/audio-separation/ProcessingStatus.jsx","../../src/components/AudioSeparation.jsx"],"sourcesContent":["// API Client - שימוש ב-URL דינמי עם תמיכה ב-Vite env\r\n// קדימות: VITE_API_BASE_URL → אותו דומיין עם /api → localhost לפיתוח\r\nconst getApiBaseUrl = () => {\r\n  // שימוש ישיר במשתנה הסביבה של Vite\r\n  const viteEnv = import.meta.env.VITE_API_BASE_URL;\r\n\r\n  if (viteEnv && typeof viteEnv === 'string' && viteEnv.length > 0) {\r\n    return viteEnv.replace(/\\/$/, '');\r\n  }\r\n\r\n  // אם אין משתנה סביבה, נשתמש בכתובת Render.com\r\n  if (typeof window !== 'undefined' && window.location && window.location.origin) {\r\n    // בדיקה אם אנחנו על localhost\r\n    if (window.location.origin.includes('localhost')) {\r\n      return 'http://localhost:10000/api';\r\n    }\r\n    // אם לא, נשתמש ב-Render.com\r\n    return 'https://kr-studio-completeai.onrender.com/api';\r\n  }\r\n\r\n  // ברירת מחדל - Render.com\r\n  return 'https://kr-studio-completeai.onrender.com/api';\r\n};\r\n\r\nconst API_BASE_URL = getApiBaseUrl();\r\n\r\n// Helper function for API calls with improved error handling\r\nconst apiCall = async (endpoint, options = {}) => {\r\n  const url = `${getApiBaseUrl()}${endpoint}`;\r\n  console.log(`🌐 [API] שולח בקשה ל: ${url}`);\r\n  console.log(`🌐 [API] שיטת בקשה: ${options.method || 'GET'}`);\r\n  console.log(`🌐 [API] כותרות:`, options.headers);\r\n  console.log(`🌐 [API] גוף הבקשה:`, options.body);\r\n  \r\n  try {\r\n    const startTime = performance.now();\r\n    const response = await fetch(url, {\r\n      ...options,\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...options.headers,\r\n      },\r\n    });\r\n    const responseTime = performance.now() - startTime;\r\n    \r\n    console.log(`🌐 [API] תשובה התקבלה ב: ${responseTime.toFixed(0)}ms`);\r\n    console.log(`🌐 [API] סטטוס תשובה: ${response.status} ${response.statusText}`);\r\n    console.log(`🌐 [API] כותרות תשובה:`, Object.fromEntries(response.headers.entries()));\r\n    \r\n    if (!response.ok) {\r\n      console.error(`❌ [API] שגיאה בתשובה: ${response.status} ${response.statusText}`);\r\n      const errorText = await response.text();\r\n      console.error(`❌ [API] תוכן שגיאה:`, errorText);\r\n      throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n    }\r\n    \r\n    const data = await response.json();\r\n    console.log(`🌐 [API] נתוני תשובה:`, data);\r\n    \r\n    // בדיקה אם התשובה כוללת שדה success\r\n    if (data && typeof data.success === 'boolean') {\r\n      if (!data.success) {\r\n        console.error(`❌ [API] תשובה נכשלה:`, data.error || 'הבקשה נכשלה');\r\n        throw new Error(data.error || 'הבקשה נכשלה');\r\n      }\r\n      console.log(`✅ [API] תשובה הצליחה`);\r\n    }\r\n    \r\n    return data;\r\n  } catch (error) {\r\n    console.error(`❌ [API] שגיאה בבקשה ל-${url}:`, error);\r\n    console.error(`❌ [API] פרטי השגיאה:`, {\r\n      message: error.message,\r\n      stack: error.stack,\r\n      name: error.name\r\n    });\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Upload audio file with progress tracking\r\nexport const uploadAudio = async (file, onProgress = null, abortController = null) => {\r\n  console.log(`📤 [API] מתחיל העלאת קובץ: ${file.name}`);\r\n  console.log(`📤 [API] גודל קובץ: ${file.size} bytes`);\r\n  console.log(`📤 [API] סוג קובץ: ${file.type}`);\r\n  \r\n  try {\r\n    const formData = new FormData();\r\n    formData.append('audio', file);\r\n    \r\n    console.log(`📤 [API] FormData נוצר עם ${formData.entries().length} שדות`);\r\n    \r\n    const startTime = performance.now();\r\n    const response = await fetch(`${getApiBaseUrl()}/api/upload`, {\r\n      method: 'POST',\r\n      body: formData,\r\n      signal: abortController?.signal,\r\n    });\r\n    const responseTime = performance.now() - startTime;\r\n    \r\n    console.log(`📤 [API] העלאה הושלמה ב: ${responseTime.toFixed(0)}ms`);\r\n    console.log(`📤 [API] סטטוס תשובה: ${response.status} ${response.statusText}`);\r\n    \r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      console.error(`❌ [API] שגיאה בהעלאה: ${response.status} ${response.statusText}`);\r\n      console.error(`❌ [API] תוכן שגיאה:`, errorText);\r\n      throw new Error(`העלאה נכשלה: ${response.status} ${response.statusText}`);\r\n    }\r\n    \r\n    const data = await response.json();\r\n    console.log(`📤 [API] תוצאת העלאה:`, data);\r\n    \r\n    if (data && data.fileId) {\r\n      console.log(`✅ [API] קובץ הועלה בהצלחה, ID: ${data.fileId}`);\r\n    } else {\r\n      console.error(`❌ [API] לא התקבל fileId מהשרת`);\r\n      throw new Error('לא התקבל מזהה קובץ מהשרת');\r\n    }\r\n    \r\n    return data;\r\n  } catch (error) {\r\n    console.error(`❌ [API] שגיאה בהעלאת קובץ ${file.name}:`, error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Separate audio with Demucs\r\nexport const separateAudio = async (fileId, projectName) => {\r\n  console.log(`🎵 [API] מתחיל הפרדת אודיו: fileId=${fileId}, projectName=${projectName}`);\r\n  \r\n  try {\r\n    const startTime = performance.now();\r\n    const data = await apiCall('/api/separate', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ fileId, projectName }),\r\n    });\r\n    const responseTime = performance.now() - startTime;\r\n    \r\n    console.log(`🎵 [API] הפרדה הושלמה ב: ${responseTime.toFixed(0)}ms`);\r\n    console.log(`🎵 [API] תוצאת הפרדה:`, data);\r\n    \r\n    return data;\r\n  } catch (error) {\r\n    console.error(`❌ [API] שגיאה בהפרדת אודיו:`, error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Get separation progress with polling\r\nexport const getSeparationProgress = async (fileId) => {\r\n  console.log(`📊 [API] בודק התקדמות הפרדה: fileId=${fileId}`);\r\n  \r\n  try {\r\n    const startTime = performance.now();\r\n    const data = await apiCall(`/api/separate/${fileId}/progress`);\r\n    const responseTime = performance.now() - startTime;\r\n    \r\n    console.log(`📊 [API] התקדמות התקבלה ב: ${responseTime.toFixed(0)}ms`);\r\n    console.log(`📊 [API] נתוני התקדמות:`, data);\r\n    \r\n    return data;\r\n  } catch (error) {\r\n    console.error(`❌ [API] שגיאה בבדיקת התקדמות:`, error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Get all projects\r\nexport const getProjects = async () => {\r\n  console.log(`📁 [API] טוען רשימת פרויקטים`);\r\n  \r\n  try {\r\n    const startTime = performance.now();\r\n    const data = await apiCall('/api/projects');\r\n    const responseTime = performance.now() - startTime;\r\n    \r\n    console.log(`📁 [API] פרויקטים נטענו ב: ${responseTime.toFixed(0)}ms`);\r\n    console.log(`📁 [API] מספר פרויקטים: ${Array.isArray(data) ? data.length : 'לא מערך'}`);\r\n    \r\n    return data;\r\n  } catch (error) {\r\n    console.error(`❌ [API] שגיאה בטעינת פרויקטים:`, error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Get specific project\r\nexport const getProject = async (id) => {\r\n  console.log(`📁 [API] טוען פרויקט: id=${id}`);\r\n  \r\n  try {\r\n    const startTime = performance.now();\r\n    const data = await apiCall(`/api/projects/${id}`);\r\n    const responseTime = performance.now() - startTime;\r\n    \r\n    console.log(`📁 [API] פרויקט נטען ב: ${responseTime.toFixed(0)}ms`);\r\n    console.log(`📁 [API] פרטי פרויקט:`, data);\r\n    \r\n    return data;\r\n  } catch (error) {\r\n    console.error(`❌ [API] שגיאה בטעינת פרויקט ${id}:`, error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Delete project\r\nexport const deleteProject = async (id) => {\r\n  console.log(`🗑️ [API] מוחק פרויקט: id=${id}`);\r\n  \r\n  try {\r\n    const startTime = performance.now();\r\n    const data = await apiCall(`/api/projects/${id}`, {\r\n      method: 'DELETE',\r\n    });\r\n    const responseTime = performance.now() - startTime;\r\n    \r\n    console.log(`🗑️ [API] פרויקט נמחק ב: ${responseTime.toFixed(0)}ms`);\r\n    console.log(`🗑️ [API] תוצאת מחיקה:`, data);\r\n    \r\n    return data;\r\n  } catch (error) {\r\n    console.error(`❌ [API] שגיאה במחיקת פרויקט ${id}:`, error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Download stem\r\nexport const downloadStem = async (projectId, stemName) => {\r\n  console.log(`⬇️ [API] מוריד stem: projectId=${projectId}, stemName=${stemName}`);\r\n  \r\n  try {\r\n    const startTime = performance.now();\r\n    const response = await fetch(`${getApiBaseUrl()}/api/projects/${projectId}/download/${stemName}`);\r\n    const responseTime = performance.now() - startTime;\r\n    \r\n    console.log(`⬇️ [API] הורדה הושלמה ב: ${responseTime.toFixed(0)}ms`);\r\n    console.log(`⬇️ [API] סטטוס הורדה: ${response.status} ${response.statusText}`);\r\n    \r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      console.error(`❌ [API] שגיאה בהורדה: ${response.status} ${response.statusText}`);\r\n      console.error(`❌ [API] תוכן שגיאה:`, errorText);\r\n      throw new Error(`הורדה נכשלה: ${response.status} ${response.statusText}`);\r\n    }\r\n    \r\n    const blob = await response.blob();\r\n    console.log(`✅ [API] stem הורד בהצלחה, גודל: ${blob.size} bytes`);\r\n    \r\n    return blob;\r\n  } catch (error) {\r\n    console.error(`❌ [API] שגיאה בהורדת stem:`, error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Health check\r\nexport const healthCheck = async () => {\r\n  console.log(`🏥 [API] בודק בריאות שרת`);\r\n  \r\n  try {\r\n    const startTime = performance.now();\r\n    const data = await apiCall('/api/health');\r\n    const responseTime = performance.now() - startTime;\r\n    \r\n    console.log(`🏥 [API] בדיקת בריאות הושלמה ב: ${responseTime.toFixed(0)}ms`);\r\n    console.log(`🏥 [API] סטטוס שרת:`, data);\r\n    \r\n    return data;\r\n  } catch (error) {\r\n    console.error(`❌ [API] שגיאה בבדיקת בריאות:`, error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Quick connection test - מהיר יותר\r\nexport const quickConnectionTest = async () => {\r\n  console.log(`⚡ [API] בדיקת חיבור מהירה`);\r\n  \r\n  try {\r\n    const startTime = performance.now();\r\n    const data = await apiCall('/api/health');\r\n    const responseTime = performance.now() - startTime;\r\n    \r\n    console.log(`⚡ [API] בדיקת חיבור מהירה הושלמה ב: ${responseTime.toFixed(0)}ms`);\r\n    console.log(`⚡ [API] תוצאת בדיקה:`, data);\r\n    \r\n    return { success: true, responseTime, data };\r\n  } catch (error) {\r\n    console.error(`❌ [API] שגיאה בבדיקת חיבור מהירה:`, error);\r\n    return { success: false, error: error.message };\r\n  }\r\n};\r\n\r\n// בדיקה נוספת של חיבור לשרת\r\nexport const testServerConnection = async () => {\r\n  console.log(`🔗 [API] בדיקת חיבור לשרת`);\r\n  \r\n  try {\r\n    const startTime = performance.now();\r\n    const data = await apiCall('/api/health');\r\n    const responseTime = performance.now() - startTime;\r\n    \r\n    console.log(`🔗 [API] בדיקת חיבור הושלמה ב: ${responseTime.toFixed(0)}ms`);\r\n    console.log(`🔗 [API] תוצאת בדיקה:`, data);\r\n    \r\n    if (data && data.status === 'OK') {\r\n      console.log(`✅ [API] שרת מחובר ופעיל`);\r\n      return true;\r\n    } else {\r\n      console.log(`❌ [API] שרת לא מגיב כראוי`);\r\n      return false;\r\n    }\r\n  } catch (error) {\r\n    console.error(`❌ [API] שגיאה בבדיקת חיבור לשרת:`, error);\r\n    return false;\r\n  }\r\n}; ","import React from 'react';\r\nimport { Play, Pause, Volume2, VolumeX, Download, Music, Mic, Volume1, Music2, Music3 } from 'lucide-react';\r\n\r\nexport default function TrackChannel({ \r\n  trackId, \r\n  trackData, \r\n  isPlaying, \r\n  volume, \r\n  isMuted, \r\n  onPlay, \r\n  onVolumeChange, \r\n  onMuteToggle, \r\n  onDownload \r\n}) {\r\n  const getTrackIcon = (trackId) => {\r\n    switch (trackId) {\r\n      case 'vocals':\r\n        return <Mic className=\"w-5 h-5 text-blue-400\" />;\r\n      case 'drums':\r\n        return <Music2 className=\"w-5 h-5 text-green-400\" />;\r\n      case 'bass':\r\n        return <Volume1 className=\"w-5 h-5 text-purple-400\" />;\r\n      case 'guitar':\r\n        return <Music3 className=\"w-5 h-5 text-orange-400\" />;\r\n      case 'other':\r\n        return <Music className=\"w-5 h-5 text-gray-400\" />;\r\n      default:\r\n        return <Music className=\"w-5 h-5 text-gray-400\" />;\r\n    }\r\n  };\r\n\r\n  const getTrackName = (trackId) => {\r\n    switch (trackId) {\r\n      case 'vocals':\r\n        return 'ווקאל';\r\n      case 'drums':\r\n        return 'תופים';\r\n      case 'bass':\r\n        return 'בס';\r\n      case 'guitar':\r\n        return 'גיטרה';\r\n      case 'other':\r\n        return 'אחר';\r\n      default:\r\n        return trackId;\r\n    }\r\n  };\r\n\r\n  const getTrackColor = (trackId) => {\r\n    switch (trackId) {\r\n      case 'vocals':\r\n        return 'border-blue-500 bg-blue-500/10';\r\n      case 'drums':\r\n        return 'border-green-500 bg-green-500/10';\r\n      case 'bass':\r\n        return 'border-purple-500 bg-purple-500/10';\r\n      case 'guitar':\r\n        return 'border-orange-500 bg-orange-500/10';\r\n      case 'other':\r\n        return 'border-gray-500 bg-gray-500/10';\r\n      default:\r\n        return 'border-gray-500 bg-gray-500/10';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={`border-2 rounded-lg p-4 ${getTrackColor(trackId)}`}>\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <div className=\"flex items-center space-x-3\">\r\n          {getTrackIcon(trackId)}\r\n          <div>\r\n            <h3 className=\"font-semibold text-white\">{getTrackName(trackId)}</h3>\r\n            <p className=\"text-sm text-gray-400\">\r\n              {trackData?.duration ? `${Math.round(trackData.duration)}s` : 'טוען...'}\r\n            </p>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"flex items-center space-x-2\">\r\n          {/* Play/Pause Button */}\r\n          <button\r\n            onClick={onPlay}\r\n            className={`p-2 rounded-lg transition-colors ${\r\n              isPlaying \r\n                ? 'bg-red-600 hover:bg-red-700 text-white' \r\n                : 'bg-green-600 hover:bg-green-700 text-white'\r\n            }`}\r\n          >\r\n            {isPlaying ? <Pause className=\"w-4 h-4\" /> : <Play className=\"w-4 h-4\" />}\r\n          </button>\r\n          \r\n          {/* Download Button */}\r\n          <button\r\n            onClick={onDownload}\r\n            className=\"p-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors\"\r\n            title=\"הורד ערוץ\"\r\n          >\r\n            <Download className=\"w-4 h-4\" />\r\n          </button>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Volume Controls */}\r\n      <div className=\"flex items-center space-x-3\">\r\n        <button\r\n          onClick={onMuteToggle}\r\n          className={`p-2 rounded-lg transition-colors ${\r\n            isMuted \r\n              ? 'bg-red-600 hover:bg-red-700 text-white' \r\n              : 'bg-gray-600 hover:bg-gray-700 text-white'\r\n          }`}\r\n          title={isMuted ? 'הפעל ערוץ' : 'השתק ערוץ'}\r\n        >\r\n          {isMuted ? <VolumeX className=\"w-4 h-4\" /> : <Volume2 className=\"w-4 h-4\" />}\r\n        </button>\r\n        \r\n        <div className=\"flex-1\">\r\n          <input\r\n            type=\"range\"\r\n            min=\"0\"\r\n            max=\"1\"\r\n            step=\"0.01\"\r\n            value={volume}\r\n            onChange={(e) => onVolumeChange(parseFloat(e.target.value))}\r\n            className=\"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider\"\r\n            disabled={isMuted}\r\n          />\r\n        </div>\r\n        \r\n        <span className=\"text-sm text-gray-400 w-12 text-right\">\r\n          {Math.round(volume * 100)}%\r\n        </span>\r\n      </div>\r\n      \r\n      {/* Waveform Placeholder */}\r\n      <div className=\"mt-4 h-16 bg-gray-800 rounded-lg flex items-center justify-center\">\r\n        <div className=\"text-gray-500 text-sm\">גל אודיו</div>\r\n      </div>\r\n    </div>\r\n  );\r\n} ","import React from 'react';\r\nimport { Music, Calendar, Clock, Play, Trash2, Download } from 'lucide-react';\r\n\r\nexport default function ProjectCard({ project, onSelect, onDelete }) {\r\n  const formatDate = (dateString) => {\r\n    try {\r\n      const date = new Date(dateString);\r\n      return date.toLocaleDateString('he-IL', {\r\n        year: 'numeric',\r\n        month: 'short',\r\n        day: 'numeric',\r\n        hour: '2-digit',\r\n        minute: '2-digit'\r\n      });\r\n    } catch (error) {\r\n      return 'תאריך לא ידוע';\r\n    }\r\n  };\r\n\r\n  const getProjectStatus = (project) => {\r\n    if (project.status === 'completed') {\r\n      return { text: 'הושלם', color: 'text-green-400', bg: 'bg-green-500/10' };\r\n    } else if (project.status === 'processing') {\r\n      return { text: 'מעבד', color: 'text-yellow-400', bg: 'bg-yellow-500/10' };\r\n    } else if (project.status === 'failed') {\r\n      return { text: 'נכשל', color: 'text-red-400', bg: 'bg-red-500/10' };\r\n    } else {\r\n      return { text: 'לא ידוע', color: 'text-gray-400', bg: 'bg-gray-500/10' };\r\n    }\r\n  };\r\n\r\n  const getStemsCount = (project) => {\r\n    if (project.stems) {\r\n      return Object.keys(project.stems).length;\r\n    }\r\n    return 0;\r\n  };\r\n\r\n  const status = getProjectStatus(project);\r\n\r\n  return (\r\n    <div className=\"bg-gray-800 border border-gray-700 rounded-lg p-4 hover:border-purple-500/50 transition-all duration-300\">\r\n      {/* Header */}\r\n      <div className=\"flex items-start justify-between mb-3\">\r\n        <div className=\"flex items-center space-x-3\">\r\n          <div className=\"w-10 h-10 bg-gradient-to-r from-purple-500 to-blue-500 rounded-lg flex items-center justify-center\">\r\n            <Music className=\"w-5 h-5 text-white\" />\r\n          </div>\r\n          <div>\r\n            <h3 className=\"font-semibold text-white text-lg truncate max-w-32\">\r\n              {project.name || 'פרויקט ללא שם'}\r\n            </h3>\r\n            <div className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${status.bg} ${status.color}`}>\r\n              {status.text}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"flex items-center space-x-2\">\r\n          <button\r\n            onClick={() => onSelect(project)}\r\n            className=\"p-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors\"\r\n            title=\"פתח פרויקט\"\r\n          >\r\n            <Play className=\"w-4 h-4\" />\r\n          </button>\r\n          \r\n          <button\r\n            onClick={() => onDelete(project.id)}\r\n            className=\"p-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors\"\r\n            title=\"מחק פרויקט\"\r\n          >\r\n            <Trash2 className=\"w-4 h-4\" />\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Project Info */}\r\n      <div className=\"space-y-2 mb-4\">\r\n        <div className=\"flex items-center justify-between text-sm\">\r\n          <span className=\"text-gray-400\">ערוצים מופרדים:</span>\r\n          <span className=\"text-white font-medium\">{getStemsCount(project)}/5</span>\r\n        </div>\r\n        \r\n        {project.createdAt && (\r\n          <div className=\"flex items-center space-x-2 text-sm text-gray-400\">\r\n            <Calendar className=\"w-4 h-4\" />\r\n            <span>{formatDate(project.createdAt)}</span>\r\n          </div>\r\n        )}\r\n        \r\n        {project.duration && (\r\n          <div className=\"flex items-center space-x-2 text-sm text-gray-400\">\r\n            <Clock className=\"w-4 h-4\" />\r\n            <span>{Math.round(project.duration)}s</span>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Stems Preview */}\r\n      {project.stems && Object.keys(project.stems).length > 0 && (\r\n        <div className=\"space-y-2\">\r\n          <h4 className=\"text-sm font-medium text-gray-300\">ערוצים זמינים:</h4>\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            {Object.keys(project.stems).map((stem) => (\r\n              <span\r\n                key={stem}\r\n                className=\"px-2 py-1 bg-gray-700 text-gray-300 text-xs rounded-full\"\r\n              >\r\n                {stem === 'vocals' ? 'ווקאל' : \r\n                 stem === 'drums' ? 'תופים' : \r\n                 stem === 'bass' ? 'בס' : \r\n                 stem === 'guitar' ? 'גיטרה' : \r\n                 stem === 'other' ? 'אחר' : stem}\r\n              </span>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Actions */}\r\n      <div className=\"mt-4 pt-3 border-t border-gray-700\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <button\r\n            onClick={() => onSelect(project)}\r\n            className=\"flex-1 bg-gradient-to-r from-purple-500 to-blue-600 hover:from-purple-600 hover:to-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-all duration-300 mr-2\"\r\n          >\r\n            פתח בסטודיו\r\n          </button>\r\n          \r\n          {project.stems && Object.keys(project.stems).length > 0 && (\r\n            <button\r\n              onClick={() => {\r\n                // הורדת כל הערוצים\r\n                Object.keys(project.stems).forEach(stem => {\r\n                  // כאן תהיה לוגיקה להורדת כל הערוצים\r\n                });\r\n              }}\r\n              className=\"p-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors\"\r\n              title=\"הורד את כל הערוצים\"\r\n            >\r\n              <Download className=\"w-4 h-4\" />\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n} ","import React from 'react';\r\nimport { Music, Upload, FileAudio } from 'lucide-react';\r\n\r\nexport default function EmptyState() {\r\n  return (\r\n    <div className=\"text-center py-12\">\r\n      <div className=\"w-24 h-24 bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-6\">\r\n        <Music className=\"w-12 h-12 text-gray-400\" />\r\n      </div>\r\n      \r\n      <h3 className=\"text-xl font-semibold text-white mb-3\">\r\n        אין ערוצי אודיו זמינים\r\n      </h3>\r\n      \r\n      <p className=\"text-gray-400 mb-6 max-w-md mx-auto\">\r\n        עדיין לא הופרדו ערוצי אודיו לפרויקט זה. אנא המתן לסיום התהליך או צור פרויקט חדש.\r\n      </p>\r\n      \r\n      <div className=\"flex items-center justify-center space-x-4 text-sm text-gray-500\">\r\n        <div className=\"flex items-center space-x-2\">\r\n          <FileAudio className=\"w-4 h-4\" />\r\n          <span>ווקאל</span>\r\n        </div>\r\n        <div className=\"flex items-center space-x-2\">\r\n          <FileAudio className=\"w-4 h-4\" />\r\n          <span>תופים</span>\r\n        </div>\r\n        <div className=\"flex items-center space-x-2\">\r\n          <FileAudio className=\"w-4 h-4\" />\r\n          <span>בס</span>\r\n        </div>\r\n        <div className=\"flex items-center space-x-2\">\r\n          <FileAudio className=\"w-4 h-4\" />\r\n          <span>גיטרה</span>\r\n        </div>\r\n        <div className=\"flex items-center space-x-2\">\r\n          <FileAudio className=\"w-4 h-4\" />\r\n          <span>אחר</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n} ","import React, { useState, useRef } from \"react\";\r\nimport { Upload, FileAudio, AlertCircle, WifiOff } from \"lucide-react\";\r\n\r\nexport default function UploadZone({ onFileSelect, onDrop, disabled = false }) {\r\n  const [isDragOver, setIsDragOver] = useState(false);\r\n  const [selectedFile, setSelectedFile] = useState(null);\r\n  const fileInputRef = useRef(null);\r\n\r\n  const handleDragOver = (e) => {\r\n    console.log(`🖱️ [UploadZone] Drag Over - disabled: ${disabled}`);\r\n    if (disabled) return;\r\n    \r\n    e.preventDefault();\r\n    setIsDragOver(true);\r\n    console.log(`✅ [UploadZone] Drag Over הופעל`);\r\n  };\r\n\r\n  const handleDragLeave = (e) => {\r\n    console.log(`🖱️ [UploadZone] Drag Leave`);\r\n    e.preventDefault();\r\n    setIsDragOver(false);\r\n    console.log(`✅ [UploadZone] Drag Leave הופעל`);\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    console.log(`🖱️ [UploadZone] Drop - disabled: ${disabled}`);\r\n    if (disabled) return;\r\n    \r\n    e.preventDefault();\r\n    setIsDragOver(false);\r\n    \r\n    const files = Array.from(e.dataTransfer.files);\r\n    console.log(`📁 [UploadZone] קבצים שהועברו:`, files.map(f => ({ name: f.name, size: f.size, type: f.type })));\r\n    \r\n    if (files.length > 0) {\r\n      const file = files[0];\r\n      console.log(`📁 [UploadZone] קובץ נבחר: ${file.name} (${file.size} bytes, ${file.type})`);\r\n      \r\n      try {\r\n        setSelectedFile(file);\r\n        onDrop(file);\r\n        console.log(`✅ [UploadZone] קובץ נמסר בהצלחה`);\r\n      } catch (error) {\r\n        console.error(`❌ [UploadZone] שגיאה במסירת קובץ:`, error);\r\n      }\r\n    } else {\r\n      console.log(`⚠️ [UploadZone] לא נמצאו קבצים ב-Drop`);\r\n    }\r\n  };\r\n\r\n  const handleFileInput = (e) => {\r\n    console.log(`🖱️ [UploadZone] File Input - disabled: ${disabled}`);\r\n    if (disabled) return;\r\n    \r\n    const files = Array.from(e.target.files);\r\n    console.log(`📁 [UploadZone] קבצים נבחרו:`, files.map(f => ({ name: f.name, size: f.size, type: f.type })));\r\n    \r\n    if (files.length > 0) {\r\n      const file = files[0];\r\n      console.log(`📁 [UploadZone] קובץ נבחר: ${file.name} (${file.size} bytes, ${file.type})`);\r\n      \r\n      try {\r\n        setSelectedFile(file);\r\n        onFileSelect(file);\r\n        console.log(`✅ [UploadZone] קובץ נמסר בהצלחה`);\r\n      } catch (error) {\r\n        console.error(`❌ [UploadZone] שגיאה במסירת קובץ:`, error);\r\n      }\r\n    } else {\r\n      console.log(`⚠️ [UploadZone] לא נמצאו קבצים בבחירה`);\r\n    }\r\n  };\r\n\r\n  const handleFileSelect = (file) => {\r\n    console.log(`📁 [UploadZone] handleFileSelect נקרא עם: ${file.name}`);\r\n    \r\n    if (!file) {\r\n      console.error(`❌ [UploadZone] קובץ לא תקין`);\r\n      return;\r\n    }\r\n    \r\n    console.log(`📁 [UploadZone] פרטי קובץ:`, {\r\n      name: file.name,\r\n      size: file.size,\r\n      type: file.type,\r\n      lastModified: new Date(file.lastModified).toISOString()\r\n    });\r\n    \r\n    try {\r\n      setSelectedFile(file);\r\n      onFileSelect(file);\r\n      console.log(`✅ [UploadZone] קובץ נמסר בהצלחה`);\r\n    } catch (error) {\r\n      console.error(`❌ [UploadZone] שגיאה במסירת קובץ:`, error);\r\n    }\r\n  };\r\n\r\n  const handleClick = () => {\r\n    console.log(`🖱️ [UploadZone] לחיצה על אזור העלאה - disabled: ${disabled}`);\r\n    if (disabled) {\r\n      console.log(`⚠️ [UploadZone] העלאה מושבתת`);\r\n      return;\r\n    }\r\n    \r\n    console.log(`✅ [UploadZone] פותח בחירת קובץ`);\r\n    document.getElementById('file-input')?.click();\r\n  };\r\n\r\n  const formatFileSize = (bytes) => {\r\n    if (bytes === 0) return '0 Bytes';\r\n    const k = 1024;\r\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    const result = parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\r\n    console.log(`📏 [UploadZone] גודל קובץ: ${bytes} bytes = ${result}`);\r\n    return result;\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div\r\n        className={`border-2 border-dashed rounded-xl p-8 text-center transition-all duration-300 ${\r\n          disabled \r\n            ? 'border-gray-500 bg-gray-800/50 cursor-not-allowed opacity-50'\r\n            : isDragOver\r\n            ? 'border-purple-500 bg-purple-500/10 cursor-pointer'\r\n            : 'border-gray-600 hover:border-purple-500 hover:bg-gray-800/50 cursor-pointer'\r\n        }`}\r\n        onDrop={handleDrop}\r\n        onDragOver={handleDragOver}\r\n        onDragEnter={handleDragOver}\r\n        onDragLeave={handleDragLeave}\r\n        onClick={handleClick}\r\n      >\r\n        <input\r\n          id=\"file-input\"\r\n          type=\"file\"\r\n          accept=\"audio/*\"\r\n          onChange={handleFileInput}\r\n          className=\"hidden\"\r\n          disabled={disabled}\r\n        />\r\n        \r\n        <div className=\"space-y-4\">\r\n          <div className=\"w-16 h-16 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center mx-auto\">\r\n            <Upload className=\"w-8 h-8 text-white\" />\r\n          </div>\r\n          \r\n          <div>\r\n            <h3 className=\"text-xl font-semibold text-white mb-2\">\r\n              העלה קובץ אודיו\r\n            </h3>\r\n            <p className=\"text-gray-400\">\r\n              גרור וזרוק קובץ אודיו לכאן, או לחץ לבחירה\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"text-sm text-gray-500 space-y-1\">\r\n            <p>קבצים נתמכים: MP3, WAV, FLAC, M4A, OGG</p>\r\n            <p>גודל מקסימלי: 50MB</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Selected File Info */}\r\n      {selectedFile && (\r\n        <div className=\"bg-gray-800 border border-gray-700 rounded-lg p-4\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <FileAudio className=\"w-8 h-8 text-blue-400\" />\r\n            <div className=\"flex-1 min-w-0\">\r\n              <h4 className=\"font-medium text-white truncate\">{selectedFile.name}</h4>\r\n              <p className=\"text-sm text-gray-400\">\r\n                {formatFileSize(selectedFile.size)} • {selectedFile.type}\r\n              </p>\r\n            </div>\r\n            <div className=\"text-green-400 text-sm font-medium\">נבחר</div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Instructions */}\r\n      <div className=\"bg-blue-900/20 border border-blue-500/30 rounded-lg p-4\">\r\n        <h4 className=\"font-medium text-blue-200 mb-2\">איך זה עובד?</h4>\r\n        <ol className=\"text-blue-200 text-sm space-y-1 list-decimal list-inside\">\r\n          <li>העלה קובץ אודיו (שיר, הקלטה, או כל קובץ אודיו אחר)</li>\r\n          <li>המערכת תנתח את האודיו ותפריד אותו ל-5 ערוצים נפרדים</li>\r\n          <li>קבל גישה לכל ערוץ בנפרד: ווקאל, תופים, בס, גיטרה ואחר</li>\r\n          <li>הורד כל ערוץ בנפרד או ערבב אותם מחדש בסטודיו</li>\r\n        </ol>\r\n      </div>\r\n\r\n      {/* Tips */}\r\n      <div className=\"bg-gray-800 border border-gray-700 rounded-lg p-4\">\r\n        <h4 className=\"font-medium text-white mb-2\">טיפים לאודיו איכותי</h4>\r\n        <ul className=\"text-gray-300 text-sm space-y-1\">\r\n          <li>• השתמש בקבצי אודיו באיכות גבוהה (320kbps MP3 או WAV)</li>\r\n          <li>• הימנע מקבצים עם רעש רקע מוגזם</li>\r\n          <li>• אורך אופטימלי: 1-10 דקות</li>\r\n          <li>• תהליך ההפרדה לוקח 2-5 דקות בהתאם לאורך הקובץ</li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  );\r\n} ","import React, { useState, useEffect } from \"react\";\r\nimport { Music, FileAudio, Zap, CheckCircle, AlertCircle, Clock, Download, Settings, RefreshCw, X } from \"lucide-react\";\r\n\r\nexport default function ProcessingStatus({ step, progress, error, fileName, onRetry, onCancel }) {\r\n  console.log(`📊 [ProcessingStatus] רכיב נטען עם:`, {\r\n    step,\r\n    progress,\r\n    error: error?.message,\r\n    fileName\r\n  });\r\n\r\n  const [elapsedTime, setElapsedTime] = useState(0);\r\n  const [estimatedTime, setEstimatedTime] = useState(null);\r\n\r\n  useEffect(() => {\r\n    let interval;\r\n    if (step === 'uploading' || step === 'separating' || step === 'processing') {\r\n      interval = setInterval(() => {\r\n        setElapsedTime(prev => prev + 1);\r\n      }, 1000);\r\n    }\r\n    return () => clearInterval(interval);\r\n  }, [step]);\r\n\r\n  useEffect(() => {\r\n    // חישוב זמן משוער לפי התקדמות\r\n    if (progress > 0 && elapsedTime > 0) {\r\n      const totalEstimated = (elapsedTime / progress) * 100;\r\n      const remaining = Math.max(0, totalEstimated - elapsedTime);\r\n      setEstimatedTime(Math.round(remaining));\r\n    }\r\n  }, [progress, elapsedTime]);\r\n\r\n  const formatTime = (seconds) => {\r\n    if (!seconds || seconds < 0) return '00:00';\r\n    \r\n    const minutes = Math.floor(seconds / 60);\r\n    const remainingSeconds = Math.floor(seconds % 60);\r\n    const result = `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;\r\n    \r\n    console.log(`⏰ [ProcessingStatus] זמן מעוצב: ${seconds}s = ${result}`);\r\n    return result;\r\n  };\r\n\r\n  const getStepIcon = (step) => {\r\n    console.log(`🎨 [ProcessingStatus] מחפש אייקון עבור שלב: ${step}`);\r\n    \r\n    switch (step) {\r\n      case 'uploading':\r\n        console.log(`🎨 [ProcessingStatus] אייקון Uploading: Upload`);\r\n        return <Upload className=\"w-8 h-8 text-blue-400\" />;\r\n      case 'separating':\r\n        console.log(`🎨 [ProcessingStatus] אייקון Separating: Split`);\r\n        return <Split className=\"w-8 h-8 text-purple-400\" />;\r\n      case 'monitoring':\r\n        console.log(`🎨 [ProcessingStatus] אייקון Monitoring: Eye`);\r\n        return <Eye className=\"w-8 h-8 text-green-400\" />;\r\n      case 'completed':\r\n        console.log(`🎨 [ProcessingStatus] אייקון Completed: CheckCircle`);\r\n        return <CheckCircle className=\"w-8 h-8 text-green-400\" />;\r\n      case 'error':\r\n        console.log(`🎨 [ProcessingStatus] אייקון Error: XCircle`);\r\n        return <XCircle className=\"w-8 h-8 text-red-400\" />;\r\n      default:\r\n        console.log(`🎨 [ProcessingStatus] אייקון ברירת מחדל עבור: ${step}`);\r\n        return <Circle className=\"w-8 h-8 text-purple-400\" />;\r\n    }\r\n  };\r\n\r\n  const getStepColor = (step) => {\r\n    console.log(`🎨 [ProcessingStatus] מחפש צבע עבור שלב: ${step}`);\r\n    \r\n    switch (step) {\r\n      case 'uploading':\r\n        console.log(`🎨 [ProcessingStatus] צבע Uploading: from-blue-500 to-blue-600`);\r\n        return 'from-blue-500 to-blue-600';\r\n      case 'separating':\r\n        console.log(`🎨 [ProcessingStatus] צבע Separating: from-purple-500 to-purple-600`);\r\n        return 'from-purple-500 to-purple-600';\r\n      case 'monitoring':\r\n        console.log(`🎨 [ProcessingStatus] צבע Monitoring: from-green-500 to-green-600`);\r\n        return 'from-green-500 to-green-600';\r\n      case 'completed':\r\n        console.log(`🎨 [ProcessingStatus] צבע Completed: from-green-500 to-green-600`);\r\n        return 'from-green-500 to-green-600';\r\n      case 'error':\r\n        console.log(`🎨 [ProcessingStatus] צבע Error: from-red-500 to-red-600`);\r\n        return 'from-red-500 to-red-600';\r\n      default:\r\n        console.log(`🎨 [ProcessingStatus] צבע ברירת מחדל עבור: ${step}`);\r\n        return 'from-purple-500 to-purple-600';\r\n    }\r\n  };\r\n\r\n  const getStepText = (step) => {\r\n    console.log(`📝 [ProcessingStatus] מחפש טקסט עבור שלב: ${step}`);\r\n    \r\n    switch (step) {\r\n      case 'uploading':\r\n        console.log(`📝 [ProcessingStatus] טקסט Uploading: מעלה קובץ...`);\r\n        return 'מעלה קובץ...';\r\n      case 'separating':\r\n        console.log(`📝 [ProcessingStatus] טקסט Separating: מפריד ערוצים...`);\r\n        return 'מפריד ערוצים...';\r\n      case 'monitoring':\r\n        console.log(`📝 [ProcessingStatus] טקסט Monitoring: עוקב אחר התקדמות...`);\r\n        return 'עוקב אחר התקדמות...';\r\n      case 'completed':\r\n        console.log(`📝 [ProcessingStatus] טקסט Completed: הושלם בהצלחה!`);\r\n        return 'הושלם בהצלחה!';\r\n      case 'error':\r\n        console.log(`📝 [ProcessingStatus] טקסט Error: שגיאה בעיבוד`);\r\n        return 'שגיאה בעיבוד';\r\n      default:\r\n        console.log(`📝 [ProcessingStatus] טקסט ברירת מחדל עבור: ${step}`);\r\n        return 'מעבד...';\r\n    }\r\n  };\r\n\r\n  const getStepDescription = (step) => {\r\n    console.log(`📄 [ProcessingStatus] מחפש תיאור עבור שלב: ${step}`);\r\n    \r\n    switch (step) {\r\n      case 'uploading':\r\n        console.log(`📄 [ProcessingStatus] תיאור Uploading: מעלה את הקובץ לשרת...`);\r\n        return 'מעלה את הקובץ לשרת...';\r\n      case 'separating':\r\n        console.log(`📄 [ProcessingStatus] תיאור Separating: מפריד את האודיו לערוצים נפרדים...`);\r\n        return 'מפריד את האודיו לערוצים נפרדים...';\r\n      case 'monitoring':\r\n        console.log(`📄 [ProcessingStatus] תיאור Monitoring: עוקב אחר התקדמות ההפרדה...`);\r\n        return 'עוקב אחר התקדמות ההפרדה...';\r\n      case 'completed':\r\n        console.log(`📄 [ProcessingStatus] תיאור Completed: ההפרדה הושלמה בהצלחה!`);\r\n        return 'ההפרדה הושלמה בהצלחה!';\r\n      case 'error':\r\n        console.log(`📄 [ProcessingStatus] תיאור Error: אירעה שגיאה בעיבוד הקובץ`);\r\n        return 'אירעה שגיאה בעיבוד הקובץ';\r\n      default:\r\n        console.log(`📄 [ProcessingStatus] תיאור ברירת מחדל עבור: ${step}`);\r\n        return 'מעבד את הקובץ...';\r\n    }\r\n  };\r\n\r\n  const handleRetry = () => {\r\n    console.log(`🔄 [ProcessingStatus] כפתור Retry נלחץ`);\r\n    try {\r\n      onRetry?.();\r\n      console.log(`✅ [ProcessingStatus] Retry הופעל בהצלחה`);\r\n    } catch (error) {\r\n      console.error(`❌ [ProcessingStatus] שגיאה ב-Retry:`, error);\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    console.log(`❌ [ProcessingStatus] כפתור Cancel נלחץ`);\r\n    try {\r\n      onCancel?.();\r\n      console.log(`✅ [ProcessingStatus] Cancel הופעל בהצלחה`);\r\n    } catch (error) {\r\n      console.error(`❌ [ProcessingStatus] שגיאה ב-Cancel:`, error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-gray-800 border border-gray-700 rounded-xl p-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <div className=\"flex items-center space-x-4\">\r\n          <div className={`w-16 h-16 bg-gradient-to-r ${getStepColor(step)} rounded-xl flex items-center justify-center`}>\r\n            {getStepIcon(step)}\r\n          </div>\r\n          <div>\r\n            <h3 className=\"text-xl font-bold text-white\">{getStepText(step)}</h3>\r\n            <p className=\"text-gray-400\">{getStepDescription(step)}</p>\r\n          </div>\r\n        </div>\r\n        \r\n        {onCancel && (\r\n          <button\r\n            onClick={handleCancel}\r\n            className=\"p-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors\"\r\n            title=\"בטל תהליך\"\r\n          >\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      {/* Progress Bar */}\r\n      <div className=\"mb-6\">\r\n        <div className=\"flex items-center justify-between mb-2\">\r\n          <span className=\"text-sm text-gray-400\">התקדמות</span>\r\n          <span className=\"text-sm font-medium text-white\">{Math.round(progress)}%</span>\r\n        </div>\r\n        <div className=\"w-full bg-gray-700 rounded-full h-3\">\r\n          <div\r\n            className={`h-3 bg-gradient-to-r ${getStepColor(step)} rounded-full transition-all duration-500 ease-out`}\r\n            style={{ width: `${progress}%` }}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Status Info */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\r\n        <div className=\"bg-gray-700/50 rounded-lg p-4\">\r\n          <div className=\"flex items-center space-x-2 mb-2\">\r\n            <Clock className=\"w-4 h-4 text-gray-400\" />\r\n            <span className=\"text-sm text-gray-400\">זמן שחלף</span>\r\n          </div>\r\n          <span className=\"text-lg font-semibold text-white\">{formatTime(elapsedTime)}</span>\r\n        </div>\r\n        \r\n        {estimatedTime !== null && (\r\n          <div className=\"bg-gray-700/50 rounded-lg p-4\">\r\n            <div className=\"flex items-center space-x-2 mb-2\">\r\n              <Clock className=\"w-4 h-4 text-gray-400\" />\r\n              <span className=\"text-sm text-gray-400\">זמן משוער נותר</span>\r\n            </div>\r\n            <span className=\"text-lg font-semibold text-white\">{formatTime(estimatedTime)}</span>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* File Info */}\r\n      {fileName && (\r\n        <div className=\"bg-gray-700/50 rounded-lg p-4 mb-6\">\r\n          <div className=\"flex items-center space-x-2 mb-2\">\r\n            <FileAudio className=\"w-4 h-4 text-gray-400\" />\r\n            <span className=\"text-sm text-gray-400\">קובץ</span>\r\n          </div>\r\n          <span className=\"text-white font-medium truncate\">{fileName}</span>\r\n        </div>\r\n      )}\r\n\r\n      {/* Error Display */}\r\n      {error && (\r\n        <div className=\"bg-red-900/50 border border-red-500 rounded-lg p-4 mb-6\">\r\n          <div className=\"flex items-center space-x-2 mb-2\">\r\n            <AlertCircle className=\"w-5 h-5 text-red-400\" />\r\n            <span className=\"text-red-200 font-medium\">שגיאה</span>\r\n          </div>\r\n          <p className=\"text-red-200\">{error}</p>\r\n        </div>\r\n      )}\r\n\r\n      {/* Actions */}\r\n      {error && onRetry && (\r\n        <div className=\"flex items-center justify-center space-x-4\">\r\n          <button\r\n            onClick={handleRetry}\r\n            className=\"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors flex items-center space-x-2\"\r\n          >\r\n            <RefreshCw className=\"w-4 h-4\" />\r\n            <span>נסה שוב</span>\r\n          </button>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Retry button for loading-project step */}\r\n      {step === 'loading-project' && onRetry && (\r\n        <div className=\"flex items-center justify-center space-x-4\">\r\n          <button\r\n            onClick={handleRetry}\r\n            className=\"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium transition-colors flex items-center space-x-2\"\r\n          >\r\n            <RefreshCw className=\"w-4 h-4\" />\r\n            <span>נסה לטעון שוב</span>\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Processing Tips */}\r\n      {step === 'separating' && (\r\n        <div className=\"bg-blue-900/20 border border-blue-500/30 rounded-lg p-4\">\r\n          <div className=\"flex items-center space-x-2 mb-2\">\r\n            <Zap className=\"w-4 h-4 text-blue-400\" />\r\n            <span className=\"text-blue-200 font-medium\">טיפים לעיבוד</span>\r\n          </div>\r\n          <ul className=\"text-blue-200 text-sm space-y-1\">\r\n            <li>• הפרדת אודיו איכותית לוקחת זמן - אנא המתן בסבלנות</li>\r\n            <li>• איכות התוצאה תלויה באיכות הקובץ המקורי</li>\r\n            <li>• ניתן לסגור את הדף - התהליך ימשיך לפעול בשרת</li>\r\n          </ul>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Loading Project Tips */}\r\n      {step === 'loading-project' && (\r\n        <div className=\"bg-green-900/20 border border-green-500/30 rounded-lg p-4\">\r\n          <div className=\"flex items-center space-x-2 mb-2\">\r\n            <RefreshCw className=\"w-4 h-4 text-green-400\" />\r\n            <span className=\"text-green-200 font-medium\">טיפים לטעינת פרויקט</span>\r\n          </div>\r\n          <ul className=\"text-green-200 text-sm space-y-1\">\r\n            <li>• ההפרדה הושלמה! המערכת טוענת את הפרויקט המוכן</li>\r\n            <li>• אם הטעינה נכשלת, לחץ על \"נסה לטעון שוב\"</li>\r\n            <li>• ניתן גם ללחוץ על \"פתח בסטודיו\" מהרשימה למטה</li>\r\n            <li>• המערכת תנסה לטעון אוטומטית מספר פעמים</li>\r\n          </ul>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n} ","import React, { useState, useEffect, useRef } from 'react';\r\nimport { Upload, Play, Pause, Download, Trash2, Music, Mic, Volume2, CircleDot, Zap, FileAudio, BarChart3, VolumeX, AlertCircle, Plus, Grid, List, Wifi, WifiOff, RefreshCw } from 'lucide-react';\r\nimport { useTranslation } from '../lib/translations';\r\n\r\n// Import API functions\r\nimport {\r\n  uploadAudio,\r\n  separateAudio,\r\n  getSeparationProgress,\r\n  getProjects,\r\n  getProject,\r\n  deleteProject,\r\n  downloadStem,\r\n  healthCheck,\r\n  quickConnectionTest\r\n} from '../api/client';\r\n\r\n// Import new components\r\nimport AudioPlayer from './audio-separation/AudioPlayer';\r\nimport ProjectCard from './audio-separation/ProjectCard';\r\nimport EmptyState from './audio-separation/EmptyState';\r\nimport UploadZone from './audio-separation/UploadZone';\r\nimport ProcessingStatus from './audio-separation/ProcessingStatus';\r\nimport TrackChannel from './audio-separation/TrackChannel';\r\n\r\nconst AudioSeparation = () => {\r\n  const [uploadedFile, setUploadedFile] = useState(null);\r\n  const [projectName, setProjectName] = useState('');\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n  const [progress, setProgress] = useState(0);\r\n  const [projects, setProjects] = useState([]);\r\n  const [selectedProject, setSelectedProject] = useState(null);\r\n  const [audioFiles, setAudioFiles] = useState({});\r\n  const [playingTrack, setPlayingTrack] = useState(null);\r\n  const [audioElements, setAudioElements] = useState({});\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [duration, setDuration] = useState(0);\r\n  const [volumeLevels, setVolumeLevels] = useState({});\r\n  const [mutedTracks, setMutedTracks] = useState({});\r\n  const [currentView, setCurrentView] = useState('upload'); // 'studio', 'upload'\r\n  const [showUploadForm, setShowUploadForm] = useState(true);\r\n  const [selectedFile, setSelectedFile] = useState(null);\r\n  const [processingStep, setProcessingStep] = useState('uploading');\r\n  const [serverConnected, setServerConnected] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [globalError, setGlobalError] = useState(null);\r\n  const [pollingInterval, setPollingInterval] = useState(null);\r\n  const [uploadController, setUploadController] = useState(null);\r\n  const [serverStatus, setServerStatus] = useState('checking'); // 'checking', 'connected', 'disconnected'\r\n  const [connectionTest, setConnectionTest] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const fileInputRef = useRef();\r\n  const audioContextRef = useRef();\r\n  const t = useTranslation();\r\n\r\n  // יצירת AudioContext\r\n  useEffect(() => {\r\n    try {\r\n      audioContextRef.current = new (window.AudioContext || window.webkitAudioContext)();\r\n      return () => {\r\n        if (audioContextRef.current) {\r\n          audioContextRef.current.close();\r\n        }\r\n        // ניקוי כל הערוצים בעת עזיבת הקומפוננטה\r\n        if (Object.keys(audioFiles).length > 0) {\r\n          stopAllTracks();\r\n        }\r\n      };\r\n    } catch (error) {\r\n      console.error('❌ שגיאה ביצירת AudioContext:', error);\r\n      setError('שגיאה באתחול מערכת האודיו - נסה לרענן את הדף');\r\n    }\r\n  }, [audioFiles]);\r\n\r\n  // בדיקת חיבור לשרת\r\n  useEffect(() => {\r\n    try {\r\n      checkServerConnection();\r\n    } catch (error) {\r\n      console.error('❌ שגיאה בבדיקת חיבור לשרת:', error);\r\n      setError('שגיאה בבדיקת חיבור לשרת - נסה לרענן את הדף');\r\n    }\r\n  }, []);\r\n\r\n  // טעינת פרויקטים קיימים\r\n  const loadProjects = async () => {\r\n    console.log('🔍 [AudioSeparation] מתחיל טעינת פרויקטים...');\r\n    try {\r\n      console.log('🔍 [AudioSeparation] בודק פרויקטים ב-localStorage...');\r\n      const savedProjects = localStorage.getItem('audioSeparationProjects');\r\n      if (savedProjects) {\r\n        console.log('🔍 [AudioSeparation] נמצאו פרויקטים ב-localStorage:', JSON.parse(savedProjects).length);\r\n        setProjects(JSON.parse(savedProjects));\r\n      } else {\r\n        console.log('🔍 [AudioSeparation] לא נמצאו פרויקטים ב-localStorage');\r\n      }\r\n\r\n      console.log('🔍 [AudioSeparation] מנסה לטעון פרויקטים מהשרת...');\r\n      const serverProjects = await getProjects();\r\n      console.log('🔍 [AudioSeparation] תשובה מהשרת:', serverProjects);\r\n      \r\n      if (serverProjects && serverProjects.length > 0) {\r\n        console.log('🔍 [AudioSeparation] נמצאו פרויקטים בשרת:', serverProjects.length);\r\n        setProjects(serverProjects);\r\n        localStorage.setItem('audioSeparationProjects', JSON.stringify(serverProjects));\r\n      } else {\r\n        console.log('🔍 [AudioSeparation] לא נמצאו פרויקטים בשרת');\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ [AudioSeparation] שגיאה בטעינת פרויקטים:', error);\r\n      console.log('🔍 [AudioSeparation] מנסה לטעון פרויקטים מ-localStorage בלבד...');\r\n      const savedProjects = localStorage.getItem('audioSeparationProjects');\r\n      if (savedProjects) {\r\n        setProjects(JSON.parse(savedProjects));\r\n      }\r\n    }\r\n  };\r\n\r\n  // בדיקה מתקדמת של מצב פרויקט\r\n  const checkProjectStatusAdvanced = async (projectId) => {\r\n    console.log(`🔍 [AudioSeparation] בודק סטטוס פרויקט מתקדם: ${projectId}`);\r\n    try {\r\n      console.log(`🔍 [AudioSeparation] שולח בקשה לשרת: /api/separate/${projectId}/progress`);\r\n      const response = await getSeparationProgress(projectId);\r\n      console.log(`🔍 [AudioSeparation] תשובה מהשרת:`, response);\r\n      \r\n      if (response && response.progress !== undefined) {\r\n        console.log(`🔍 [AudioSeparation] עדכון סטטוס: ${response.progress}% - ${response.status}`);\r\n        setProjects(prev => prev.map(p => \r\n          p.id === projectId \r\n            ? { ...p, progress: response.progress, status: response.status }\r\n            : p\r\n        ));\r\n        \r\n        if (response.status === 'completed') {\r\n          console.log(`🔍 [AudioSeparation] פרויקט הושלם: ${projectId}`);\r\n          await loadProject(projectId);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(`❌ [AudioSeparation] שגיאה בבדיקת סטטוס פרויקט ${projectId}:`, error);\r\n      console.log(`🔍 [AudioSeparation] מנסה לטעון פרויקט ישירות...`);\r\n      try {\r\n        await loadProject(projectId);\r\n      } catch (loadError) {\r\n        console.error(`❌ [AudioSeparation] שגיאה בטעינת פרויקט ${projectId}:`, loadError);\r\n      }\r\n    }\r\n  };\r\n\r\n  // טעינה חוזרת של פרויקט עם בדיקה מתקדמת\r\n  const retryProjectLoadAdvanced = async (projectId) => {\r\n    console.log(`🔄 [AudioSeparation] מנסה לטעון פרויקט מחדש: ${projectId}`);\r\n    try {\r\n      console.log(`🔍 [AudioSeparation] בודק סטטוס פרויקט...`);\r\n      const statusResponse = await getSeparationProgress(projectId);\r\n      console.log(`🔍 [AudioSeparation] סטטוס פרויקט:`, statusResponse);\r\n      \r\n      if (statusResponse && statusResponse.status === 'completed') {\r\n        console.log(`🔍 [AudioSeparation] פרויקט הושלם, טוען קבצים...`);\r\n        await loadProject(projectId);\r\n      } else if (statusResponse && statusResponse.status === 'processing') {\r\n        console.log(`🔍 [AudioSeparation] פרויקט עדיין בעיבוד, מתחיל מעקב...`);\r\n        startProgressPolling(projectId);\r\n      } else {\r\n        console.log(`🔍 [AudioSeparation] סטטוס לא ידוע, מנסה לטעון פרויקט...`);\r\n        await loadProject(projectId);\r\n      }\r\n    } catch (error) {\r\n      console.error(`❌ [AudioSeparation] שגיאה בניסיון חוזר לטעינת פרויקט ${projectId}:`, error);\r\n      console.log(`🔍 [AudioSeparation] מנסה לטעון פרויקט ישירות...`);\r\n      try {\r\n        await loadProject(projectId);\r\n      } catch (loadError) {\r\n        console.error(`❌ [AudioSeparation] שגיאה בטעינת פרויקט ישירות:`, loadError);\r\n      }\r\n    }\r\n  };\r\n\r\n  // טעינת פרויקט ספציפי\r\n  const loadProject = async (projectId) => {\r\n    console.log(`🔍 [AudioSeparation] טוען פרויקט: ${projectId}`);\r\n    try {\r\n      console.log(`🔍 [AudioSeparation] שולח בקשה לשרת: /api/projects/${projectId}`);\r\n      const project = await getProject(projectId);\r\n      console.log(`🔍 [AudioSeparation] תשובה מהשרת:`, project);\r\n      \r\n      if (project) {\r\n        console.log(`🔍 [AudioSeparation] פרויקט נטען בהצלחה:`, project.projectName);\r\n        setProjects(prev => prev.map(p => \r\n          p.id === projectId \r\n            ? { ...p, ...project, status: 'completed', progress: 100 }\r\n            : p\r\n        ));\r\n        setSelectedProject(project);\r\n        setCurrentView('studio');\r\n      } else {\r\n        console.log(`🔍 [AudioSeparation] פרויקט לא נמצא בשרת`);\r\n      }\r\n    } catch (error) {\r\n      console.error(`❌ [AudioSeparation] שגיאה בטעינת פרויקט ${projectId}:`, error);\r\n      console.log(`🔍 [AudioSeparation] מנסה לטעון פרויקט מ-localStorage...`);\r\n      const savedProjects = JSON.parse(localStorage.getItem('audioSeparationProjects') || '[]');\r\n      const savedProject = savedProjects.find(p => p.id === projectId);\r\n      if (savedProject) {\r\n        console.log(`🔍 [AudioSeparation] פרויקט נמצא ב-localStorage:`, savedProject.projectName);\r\n        setSelectedProject(savedProject);\r\n        setCurrentView('studio');\r\n      }\r\n    }\r\n  };\r\n\r\n  // מחיקת פרויקט\r\n  const handleDeleteProject = async (projectId) => {\r\n    console.log(`🗑️ [AudioSeparation] מוחק פרויקט: ${projectId}`);\r\n    try {\r\n      console.log(`🔍 [AudioSeparation] שולח בקשה מחיקה לשרת: DELETE /api/projects/${projectId}`);\r\n      await deleteProject(projectId);\r\n      console.log(`🔍 [AudioSeparation] פרויקט נמחק מהשרת בהצלחה`);\r\n      \r\n      setProjects(prev => prev.filter(p => p.id !== projectId));\r\n      if (selectedProject?.id === projectId) {\r\n        setSelectedProject(null);\r\n        setCurrentView('upload');\r\n      }\r\n      \r\n      const savedProjects = JSON.parse(localStorage.getItem('audioSeparationProjects') || '[]');\r\n      const updatedProjects = savedProjects.filter(p => p.id !== projectId);\r\n      localStorage.setItem('audioSeparationProjects', JSON.stringify(updatedProjects));\r\n      console.log(`🔍 [AudioSeparation] פרויקט נמחק מ-localStorage`);\r\n    } catch (error) {\r\n      console.error(`❌ [AudioSeparation] שגיאה במחיקת פרויקט ${projectId}:`, error);\r\n      console.log(`🔍 [AudioSeparation] מנסה למחוק מ-localStorage בלבד...`);\r\n      \r\n      setProjects(prev => prev.filter(p => p.id !== projectId));\r\n      if (selectedProject?.id === projectId) {\r\n        setSelectedProject(null);\r\n        setCurrentView('upload');\r\n      }\r\n      \r\n      const savedProjects = JSON.parse(localStorage.getItem('audioSeparationProjects') || '[]');\r\n      const updatedProjects = savedProjects.filter(p => p.id !== projectId);\r\n      localStorage.setItem('audioSeparationProjects', JSON.stringify(updatedProjects));\r\n    }\r\n  };\r\n\r\n  // טיפול בהעלאת קובץ\r\n  const handleFileUpload = async (file) => {\r\n    console.log('📁 [AudioSeparation] קובץ נבחר:', file.name, 'גודל:', file.size, 'סוג:', file.type);\r\n    \r\n    if (!file) {\r\n      console.log('❌ [AudioSeparation] קובץ לא תקין');\r\n      return;\r\n    }\r\n\r\n    // בדיקת תקינות קובץ\r\n    const validTypes = ['audio/mpeg', 'audio/wav', 'audio/flac', 'audio/mp4', 'audio/ogg'];\r\n    if (!validTypes.includes(file.type)) {\r\n      console.log('❌ [AudioSeparation] סוג קובץ לא נתמך:', file.type);\r\n      alert('סוג קובץ לא נתמך. אנא בחר קובץ אודיו (MP3, WAV, FLAC, M4A, OGG)');\r\n      return;\r\n    }\r\n\r\n    if (file.size > 100 * 1024 * 1024) { // 100MB\r\n      console.log('❌ [AudioSeparation] קובץ גדול מדי:', file.size / (1024 * 1024), 'MB');\r\n      alert('הקובץ גדול מדי. גודל מקסימלי: 100MB');\r\n      return;\r\n    }\r\n\r\n    console.log('✅ [AudioSeparation] קובץ תקין, ממשיך...');\r\n    setUploadedFile(file);\r\n    setCurrentView('upload');\r\n  };\r\n\r\n  // התחלת הפרדה\r\n  const startSeparation = async () => {\r\n    if (!uploadedFile || !projectName.trim()) {\r\n      console.log('❌ [AudioSeparation] חסרים נתונים להפרדה');\r\n      return;\r\n    }\r\n\r\n    console.log('🚀 [AudioSeparation] מתחיל הפרדת אודיו...');\r\n    console.log('📁 [AudioSeparation] פרטי הקובץ:', {\r\n      name: uploadedFile.name,\r\n      size: uploadedFile.size,\r\n      type: uploadedFile.type\r\n    });\r\n    console.log('📝 [AudioSeparation] שם הפרויקט:', projectName);\r\n\r\n    setIsProcessing(true);\r\n    setProcessingStep('uploading');\r\n    setProcessingProgress(0);\r\n\r\n    try {\r\n      console.log('🔍 [AudioSeparation] מתחיל העלאה לשרת...');\r\n      const uploadResult = await uploadAudio(uploadedFile, (progress) => {\r\n        console.log(`📤 [AudioSeparation] התקדמות העלאה: ${progress}%`);\r\n        setProcessingProgress(progress);\r\n      });\r\n      \r\n      console.log('🔍 [AudioSeparation] תוצאת העלאה:', uploadResult);\r\n      \r\n      if (uploadResult && uploadResult.fileId) {\r\n        const fileId = uploadResult.fileId;\r\n        console.log(`🔍 [AudioSeparation] קובץ הועלה בהצלחה, ID: ${fileId}`);\r\n        \r\n        setProcessingStep('separating');\r\n        setProcessingProgress(10);\r\n        \r\n        console.log(`🔍 [AudioSeparation] מתחיל הפרדה...`);\r\n        const separationResult = await separateAudio(fileId, projectName);\r\n        console.log(`🔍 [AudioSeparation] תוצאת הפרדה:`, separationResult);\r\n        \r\n        if (separationResult && separationResult.success) {\r\n          console.log(`🔍 [AudioSeparation] הפרדה החלה בהצלחה`);\r\n          \r\n          const newProject = {\r\n            id: fileId,\r\n            projectName: projectName,\r\n            fileName: uploadedFile.name,\r\n            status: 'processing',\r\n            progress: 10,\r\n            createdAt: new Date().toISOString(),\r\n            stems: []\r\n          };\r\n          \r\n          console.log(`🔍 [AudioSeparation] יוצר פרויקט חדש:`, newProject);\r\n          setProjects(prev => [...prev, newProject]);\r\n          \r\n          const savedProjects = JSON.parse(localStorage.getItem('audioSeparationProjects') || '[]');\r\n          savedProjects.push(newProject);\r\n          localStorage.setItem('audioSeparationProjects', JSON.stringify(savedProjects));\r\n          console.log(`🔍 [AudioSeparation] פרויקט נשמר ב-localStorage`);\r\n          \r\n          setSelectedProject(newProject);\r\n          setCurrentView('studio');\r\n          setProcessingStep('monitoring');\r\n          \r\n          console.log(`🔍 [AudioSeparation] מתחיל מעקב אחר התקדמות...`);\r\n          startProgressPolling(fileId);\r\n        } else {\r\n          console.error(`❌ [AudioSeparation] הפרדה נכשלה:`, separationResult);\r\n          throw new Error(separationResult?.error || 'הפרדה נכשלה');\r\n        }\r\n      } else {\r\n        console.error(`❌ [AudioSeparation] העלאה נכשלה:`, uploadResult);\r\n        throw new Error('העלאה נכשלה');\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ [AudioSeparation] שגיאה בהפרדת אודיו:', error);\r\n      setProcessingError(error.message);\r\n      setProcessingStep('error');\r\n    } finally {\r\n      setIsProcessing(false);\r\n      setProcessingProgress(0);\r\n    }\r\n  };\r\n\r\n  // התחלת מעקב אחר התקדמות\r\n  const startProgressPolling = (fileId) => {\r\n    console.log(`🔍 [AudioSeparation] מתחיל מעקב אחר התקדמות: ${fileId}`);\r\n    \r\n    const pollProgress = async () => {\r\n      try {\r\n        console.log(`🔍 [AudioSeparation] בודק התקדמות: ${fileId}`);\r\n        const progress = await getSeparationProgress(fileId);\r\n        console.log(`🔍 [AudioSeparation] התקדמות:`, progress);\r\n        \r\n        if (progress && progress.progress !== undefined) {\r\n          console.log(`🔍 [AudioSeparation] עדכון התקדמות: ${progress.progress}%`);\r\n          setProjects(prev => prev.map(p => \r\n            p.id === fileId \r\n              ? { ...p, progress: progress.progress, status: progress.status }\r\n              : p\r\n          ));\r\n          \r\n          if (progress.status === 'completed') {\r\n            console.log(`🔍 [AudioSeparation] פרויקט הושלם: ${fileId}`);\r\n            clearInterval(progressInterval);\r\n            await loadProject(fileId);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error(`❌ [AudioSeparation] שגיאה בבדיקת התקדמות ${fileId}:`, error);\r\n      }\r\n    };\r\n\r\n    const progressInterval = setInterval(pollProgress, 2000);\r\n    console.log(`🔍 [AudioSeparation] מעקב התקדמות מופעל כל 2 שניות`);\r\n    \r\n    // ניקוי אוטומטי אחרי 10 דקות\r\n    setTimeout(() => {\r\n      console.log(`🔍 [AudioSeparation] ניקוי מעקב התקדמות אחרי 10 דקות`);\r\n      clearInterval(progressInterval);\r\n    }, 10 * 60 * 1000);\r\n  };\r\n\r\n  // ניסיון חוזר לתהליך\r\n  const retryProcessing = async () => {\r\n    console.log('🔄 מנסה שוב את התהליך...');\r\n    setError(null);\r\n    \r\n    try {\r\n      // אם יש פרויקט שנבחר, נסה לטעון אותו מחדש\r\n      if (selectedProject && selectedProject.id) {\r\n        console.log('🔄 מנסה לטעון פרויקט קיים:', selectedProject.id);\r\n        \r\n        // בדיקה מתקדמת של מצב הפרויקט\r\n        const status = await checkProjectStatusAdvanced(selectedProject.id);\r\n        console.log('🔍 סטטוס פרויקט:', status);\r\n        \r\n        if (status.isReady) {\r\n          // הפרויקט מוכן, נסה לטעון אותו\r\n          const loadSuccess = await loadProject(selectedProject.id);\r\n          \r\n          if (loadSuccess) {\r\n            console.log('🎉 הפרויקט נטען בהצלחה!');\r\n            setError(null);\r\n            return;\r\n          } else {\r\n            console.error('❌ הפרויקט לא נטען למרות שהוא מוכן');\r\n            setError('הפרויקט מוכן אבל לא נטען. נסה לרענן את הדף.');\r\n            return;\r\n          }\r\n        } else {\r\n          // הפרויקט לא מוכן, הצג מידע מפורט\r\n          console.warn('⚠️ הפרויקט לא מוכן:', status.reason);\r\n          setError(status.reason);\r\n          \r\n          // אם זה שלב טעינת פרויקט, נסה שוב אחרי המתנה\r\n          if (processingStep === 'loading-project') {\r\n            console.log('⏳ ממתין 5 שניות ונסה שוב...');\r\n            setTimeout(() => {\r\n              retryProcessing();\r\n            }, 5000);\r\n          }\r\n          return;\r\n        }\r\n      }\r\n      \r\n      // אם אין פרויקט נבחר או שהטעינה נכשלה, נסה עם הקובץ המקורי\r\n      if (selectedFile) {\r\n        console.log('🔄 מנסה שוב עם הקובץ המקורי...');\r\n        await handleFileUpload(selectedFile);\r\n      } else if (uploadedFile) {\r\n        console.log('🔄 מנסה שוב עם הקובץ שהועלה...');\r\n        await handleFileUpload(uploadedFile);\r\n      } else {\r\n        // אם אין קובץ, חזור למסך העלאה\r\n        console.log('🔄 אין קובץ זמין, חוזר למסך העלאה...');\r\n        resetToUpload();\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ שגיאה בניסיון חוזר:', error);\r\n      setError(`ניסיון חוזר נכשל: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  // ביטול תהליך\r\n  const cancelProcessing = () => {\r\n    console.log('❌ מבטל תהליך...');\r\n    \r\n    try {\r\n      // ביטול העלאה אם יש\r\n      if (uploadController) {\r\n        uploadController.abort();\r\n        setUploadController(null);\r\n      }\r\n      \r\n      // עצירת polling\r\n      if (pollingInterval) {\r\n        clearInterval(pollingInterval);\r\n        setPollingInterval(null);\r\n      }\r\n      \r\n      // איפוס מצב\r\n      setIsProcessing(false);\r\n      setProcessingStep(null);\r\n      setProgress(0);\r\n      setError(null);\r\n      setUploadedFile(null);\r\n      setSelectedFile(null);\r\n      setProjectName(''); // איפוס שם הפרויקט גם בביטול\r\n      \r\n      console.log('✅ תהליך בוטל');\r\n    } catch (error) {\r\n      console.error('❌ שגיאה בביטול תהליך:', error);\r\n      setError('שגיאה בביטול התהליך - נסה שוב');\r\n    }\r\n  };\r\n\r\n  // הורדת ערוץ\r\n  const handleDownloadStem = async (projectId, stemType) => {\r\n    try {\r\n      console.log('📥 מוריד ערוץ:', stemType, 'מפרויקט:', projectId);\r\n      \r\n      const result = await downloadStem(projectId, stemType);\r\n      \r\n      if (result && result.url) {\r\n        // יצירת קישור הורדה\r\n        const link = document.createElement('a');\r\n        link.href = result.url;\r\n        link.download = `${stemType}_${projectId}.wav`;\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n        \r\n        console.log('✅ ערוץ הורד בהצלחה');\r\n      } else {\r\n        throw new Error('לא התקבל קישור הורדה מהשרת');\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ שגיאה בהורדת ערוץ:', error);\r\n      \r\n      // הודעה מפורטת יותר למשתמש\r\n      let errorMessage = error.message;\r\n      if (error.message.includes('timeout')) {\r\n        errorMessage = 'הורדת ערוץ נכשלה - זמן המתנה ארוך מדי';\r\n      } else if (error.message.includes('Failed to fetch')) {\r\n        errorMessage = 'לא ניתן להתחבר לשרת - בדוק את החיבור לאינטרנט';\r\n      } else if (error.message.includes('NetworkError')) {\r\n        errorMessage = 'שגיאת רשת - בדוק את החיבור לאינטרנט';\r\n      } else if (error.message.includes('404')) {\r\n        errorMessage = 'הערוץ לא נמצא - ייתכן שהפרויקט לא הושלם עדיין';\r\n      } else if (error.message.includes('403')) {\r\n        errorMessage = 'אין לך הרשאה להוריד ערוץ זה';\r\n      } else if (error.message.includes('500')) {\r\n        errorMessage = 'שגיאת שרת - נסה שוב מאוחר יותר';\r\n      } else if (error.message.includes('503')) {\r\n        errorMessage = 'השרת לא זמין כרגע - נסה שוב מאוחר יותר';\r\n      }\r\n      \r\n      setError(errorMessage);\r\n    }\r\n  };\r\n\r\n  // ניהול אודיו\r\n  const playTrack = (trackId) => {\r\n    try {\r\n      if (playingTrack === trackId) {\r\n        // עצירת הפעלה\r\n        if (audioElements[trackId]) {\r\n          audioElements[trackId].pause();\r\n          audioElements[trackId].currentTime = 0;\r\n        }\r\n        setPlayingTrack(null);\r\n      } else {\r\n        // עצירת כל הפעלות אחרות\r\n        stopAllTracks();\r\n        \r\n        // הפעלת הערוץ הנבחר\r\n        if (audioFiles[trackId]) {\r\n          const audio = new Audio(audioFiles[trackId].url);\r\n          audio.volume = volumeLevels[trackId] || 1.0;\r\n          audio.muted = mutedTracks[trackId] || false;\r\n          \r\n          audio.addEventListener('ended', () => setPlayingTrack(null));\r\n          audio.addEventListener('timeupdate', () => setCurrentTime(audio.currentTime));\r\n          audio.addEventListener('loadedmetadata', () => setDuration(audio.duration));\r\n          \r\n          audio.play();\r\n          setAudioElements(prev => ({ ...prev, [trackId]: audio }));\r\n          setPlayingTrack(trackId);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ שגיאה בהפעלת ערוץ:', error);\r\n      setError('שגיאה בהפעלת ערוץ - נסה שוב');\r\n    }\r\n  };\r\n\r\n  const stopAllTracks = () => {\r\n    try {\r\n      Object.values(audioElements).forEach(audio => {\r\n        if (audio) {\r\n          audio.pause();\r\n          audio.currentTime = 0;\r\n        }\r\n      });\r\n      setAudioElements({});\r\n      setPlayingTrack(null);\r\n      setCurrentTime(0);\r\n    } catch (error) {\r\n      console.error('❌ שגיאה בעצירת כל הערוצים:', error);\r\n      // לא מציג שגיאה למשתמש כי זה לא קריטי\r\n    }\r\n  };\r\n\r\n  const setTrackVolume = (trackId, volume) => {\r\n    try {\r\n      setVolumeLevels(prev => ({ ...prev, [trackId]: volume }));\r\n      \r\n      if (audioElements[trackId]) {\r\n        audioElements[trackId].volume = volume;\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ שגיאה בעדכון עוצמת ערוץ:', error);\r\n      // לא מציג שגיאה למשתמש כי זה לא קריטי\r\n    }\r\n  };\r\n\r\n  const toggleTrackMute = (trackId) => {\r\n    try {\r\n      setMutedTracks(prev => ({ ...prev, [trackId]: !prev[trackId] }));\r\n      \r\n      if (audioElements[trackId]) {\r\n        audioElements[trackId].muted = !mutedTracks[trackId];\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ שגיאה בעדכון השתקת ערוץ:', error);\r\n      // לא מציג שגיאה למשתמש כי זה לא קריטי\r\n    }\r\n  };\r\n\r\n  const resetToUpload = () => {\r\n    try {\r\n      setCurrentView('upload');\r\n      setShowUploadForm(true);\r\n      setSelectedProject(null);\r\n      setAudioFiles({});\r\n      setError(null);\r\n      setProgress(0);\r\n      setProcessingStep(null);\r\n      setIsProcessing(false);\r\n      \r\n      // עצירת כל האודיו\r\n      stopAllTracks();\r\n      \r\n      // ניקוי polling\r\n      if (pollingInterval) {\r\n        clearInterval(pollingInterval);\r\n        setPollingInterval(null);\r\n      }\r\n      \r\n      console.log('✅ חזרה למסך העלאה');\r\n    } catch (error) {\r\n      console.error('❌ שגיאה בחזרה למסך העלאה:', error);\r\n      setError('שגיאה בחזרה למסך העלאה - נסה שוב');\r\n    }\r\n  };\r\n\r\n  // ניקוי בעת עזיבת הקומפוננטה\r\n  useEffect(() => {\r\n    return () => {\r\n      try {\r\n        if (pollingInterval) {\r\n          clearInterval(pollingInterval);\r\n        }\r\n        if (uploadController) {\r\n          uploadController.abort();\r\n        }\r\n        stopAllTracks();\r\n      } catch (error) {\r\n        console.error('❌ שגיאה בניקוי הקומפוננטה:', error);\r\n        // לא מציג שגיאה למשתמש כי זה לא קריטי\r\n      }\r\n    };\r\n  }, [pollingInterval, uploadController]);\r\n\r\n  // אם השרת לא מחובר, הצג הודעת שגיאה\r\n  if (serverStatus === 'disconnected') {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-900 text-white p-6\">\r\n        <div className=\"max-w-4xl mx-auto\">\r\n          <div className=\"text-center space-y-6\">\r\n            <div className=\"text-6xl\">🎵</div>\r\n            <h1 className=\"text-3xl font-bold text-red-400\">לא ניתן להתחבר לשרת</h1>\r\n            <p className=\"text-gray-300 text-lg\">\r\n              השרת לא זמין כרגע. אנא נסה שוב מאוחר יותר או פנה לתמיכה.\r\n            </p>\r\n            {globalError && (\r\n              <div className=\"bg-red-900/50 border border-red-500 rounded-lg p-4 max-w-md mx-auto\">\r\n                <p className=\"text-red-200\">{globalError}</p>\r\n              </div>\r\n            )}\r\n            <button\r\n              onClick={retryConnection}\r\n              className=\"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors\"\r\n            >\r\n              נסה שוב\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // אם השרת בודק חיבור, הצג טעינה\r\n  if (serverStatus === 'checking') {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-900 text-white p-6\">\r\n        <div className=\"max-w-4xl mx-auto\">\r\n          <div className=\"text-center space-y-6\">\r\n            <div className=\"text-6xl animate-pulse\">🎵</div>\r\n            <h1 className=\"text-3xl font-bold\">בודק חיבור לשרת...</h1>\r\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto\"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // בדיקה אוטומטית של פרויקטים קיימים\r\n  const checkExistingProjects = async () => {\r\n    console.log('🔍 [AudioSeparation] בודק פרויקטים קיימים...');\r\n    try {\r\n      console.log('🔍 [AudioSeparation] שולח בקשה לשרת: GET /api/projects');\r\n      const projects = await getProjects();\r\n      console.log('🔍 [AudioSeparation] תשובה מהשרת:', projects);\r\n      \r\n      if (projects && projects.length > 0) {\r\n        console.log(`🔍 [AudioSeparation] נמצאו ${projects.length} פרויקטים בשרת`);\r\n        setProjects(projects);\r\n        localStorage.setItem('audioSeparationProjects', JSON.stringify(projects));\r\n      } else {\r\n        console.log('🔍 [AudioSeparation] לא נמצאו פרויקטים בשרת');\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ [AudioSeparation] שגיאה בבדיקת פרויקטים קיימים:', error);\r\n      console.log('🔍 [AudioSeparation] מנסה לטעון פרויקטים מ-localStorage...');\r\n      const savedProjects = localStorage.getItem('audioSeparationProjects');\r\n      if (savedProjects) {\r\n        setProjects(JSON.parse(savedProjects));\r\n      }\r\n    }\r\n  };\r\n\r\n  // בדיקה חוזרת של חיבור לשרת\r\n  const retryConnection = async () => {\r\n    console.log('🔄 [AudioSeparation] מנסה חיבור מחדש...');\r\n    try {\r\n      console.log('🔍 [AudioSeparation] בודק חיבור לשרת...');\r\n      const healthCheck = await healthCheck();\r\n      console.log('🔍 [AudioSeparation] בדיקת בריאות:', healthCheck);\r\n      \r\n      if (healthCheck && healthCheck.status === 'OK') {\r\n        console.log('✅ [AudioSeparation] חיבור לשרת הוחזר');\r\n        setServerStatus('connected');\r\n        await checkExistingProjects();\r\n      } else {\r\n        console.log('❌ [AudioSeparation] שרת לא מגיב');\r\n        setServerStatus('disconnected');\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ [AudioSeparation] שגיאה בבדיקת חיבור:', error);\r\n      setServerStatus('disconnected');\r\n    }\r\n  };\r\n\r\n  // בדיקת חיבור לשרת\r\n  const checkServerConnection = async () => {\r\n    console.log('🔍 [AudioSeparation] בודק חיבור לשרת...');\r\n    try {\r\n      console.log('🔍 [AudioSeparation] שולח בדיקת בריאות לשרת...');\r\n      const healthCheck = await healthCheck();\r\n      console.log('🔍 [AudioSeparation] תשובת בדיקת בריאות:', healthCheck);\r\n      \r\n      if (healthCheck && healthCheck.status === 'OK') {\r\n        console.log('✅ [AudioSeparation] שרת מחובר ופעיל');\r\n        setServerStatus('connected');\r\n        await checkExistingProjects();\r\n      } else {\r\n        console.log('❌ [AudioSeparation] שרת לא מגיב כראוי');\r\n        setServerStatus('disconnected');\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ [AudioSeparation] שגיאה בבדיקת חיבור לשרת:', error);\r\n      console.log('🔍 [AudioSeparation] פרטי השגיאה:', {\r\n        message: error.message,\r\n        stack: error.stack,\r\n        name: error.name\r\n      });\r\n      setServerStatus('disconnected');\r\n    }\r\n  };\r\n\r\n  // טעינת פרויקטים קיימים\r\n  useEffect(() => {\r\n    if (serverConnected) {\r\n      try {\r\n        console.log('📁 ===== טעינה אוטומטית של פרויקטים =====');\r\n        console.log('⏰ זמן טעינה:', new Date().toISOString());\r\n        \r\n        loadProjects();\r\n        \r\n        // בדיקה אוטומטית של פרויקטים קיימים אחרי 3 שניות\r\n        setTimeout(() => {\r\n          console.log('🔍 ===== בדיקה אוטומטית של פרויקטים קיימים =====');\r\n          checkExistingProjects();\r\n        }, 3000);\r\n        \r\n      } catch (error) {\r\n        console.error('❌ שגיאה בטעינת פרויקטים:', error);\r\n        setError('שגיאה בטעינת פרויקטים - נסה לרענן את הדף');\r\n      }\r\n    }\r\n  }, [serverConnected]);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-900 text-white\">\r\n      {/* Header */}\r\n      <div className=\"bg-gray-800 border-b border-gray-700\">\r\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n          <div className=\"flex items-center justify-between h-16\">\r\n            <div className=\"flex items-center space-x-4\">\r\n              <Music className=\"w-8 h-8 text-purple-400\" />\r\n              <h1 className=\"text-xl font-bold\">הפרדת אודיו מתקדמת</h1>\r\n            </div>\r\n            \r\n            <div className=\"flex items-center space-x-4\">\r\n              {/* Server Status */}\r\n              <div className=\"flex items-center space-x-2\">\r\n                {serverStatus === 'connected' ? (\r\n                  <Wifi className=\"w-5 h-5 text-green-400\" />\r\n                ) : (\r\n                  <WifiOff className=\"w-5 h-5 text-red-400\" />\r\n                )}\r\n                <span className=\"text-sm text-gray-300\">\r\n                  {serverStatus === 'connected' ? 'מחובר' : 'מנותק'}\r\n                </span>\r\n              </div>\r\n              \r\n              {/* View Toggle */}\r\n              {currentView === 'studio' && (\r\n                <button\r\n                  onClick={resetToUpload}\r\n                  className=\"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors\"\r\n                >\r\n                  פרויקט חדש\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n        {currentView === 'upload' ? (\r\n          // Upload View\r\n          <div className=\"space-y-8\">\r\n            {/* Welcome Section */}\r\n            <div className=\"text-center space-y-4\">\r\n              <div className=\"text-6xl\">🎵</div>\r\n              <h2 className=\"text-3xl font-bold text-white\">\r\n                הפרדת אודיו מתקדמת עם AI\r\n              </h2>\r\n              <p className=\"text-xl text-gray-300 max-w-2xl mx-auto\">\r\n                הפרד את האודיו שלך ל-5 ערוצים נפרדים: ווקאל, בס, תופים, כלי נגינה ואחר\r\n              </p>\r\n            </div>\r\n\r\n            {/* Upload Zone - הצג רק כאשר אין עיבוד */}\r\n            {!isProcessing && (\r\n              <div className=\"max-w-2xl mx-auto\">\r\n                <UploadZone\r\n                  onFileSelect={handleFileUpload}\r\n                  disabled={isProcessing}\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            {/* Processing Status - הצג כאשר יש עיבוד */}\r\n            {isProcessing && (\r\n              <div className=\"max-w-2xl mx-auto\">\r\n                {console.log('🔄 מציג מסך התקדמות - isProcessing:', isProcessing, 'step:', processingStep, 'progress:', progress)}\r\n                <ProcessingStatus\r\n                  step={processingStep}\r\n                  progress={progress}\r\n                  error={error}\r\n                  fileName={uploadedFile?.name || selectedFile?.name}\r\n                  onCancel={cancelProcessing}\r\n                  onRetry={selectedProject && selectedProject.id ? \r\n                    () => retrySpecificProject(selectedProject.id) : \r\n                    retryProcessing\r\n                  }\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            {/* Error Display */}\r\n            {error && (\r\n              <div className=\"max-w-2xl mx-auto\">\r\n                <div className=\"bg-red-900/50 border border-red-500 rounded-lg p-4\">\r\n                  <div className=\"flex items-center space-x-2 mb-3\">\r\n                    <AlertCircle className=\"w-5 h-5 text-red-400\" />\r\n                    <span className=\"text-red-200\">{error}</span>\r\n                  </div>\r\n                  \r\n                  {/* כפתורי פעולה נוספים */}\r\n                  <div className=\"flex items-center justify-center space-x-3\">\r\n                    <button\r\n                      onClick={checkExistingProjects}\r\n                      className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2\"\r\n                    >\r\n                      <RefreshCw className=\"w-4 h-4\" />\r\n                      <span>בדוק פרויקטים קיימים</span>\r\n                    </button>\r\n                    \r\n                    {selectedProject && selectedProject.id && (\r\n                      <button\r\n                        onClick={() => retrySpecificProject(selectedProject.id)}\r\n                        className=\"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2\"\r\n                      >\r\n                        <RefreshCw className=\"w-4 h-4\" />\r\n                        <span>נסה לטעון שוב</span>\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Existing Projects - הצג רק כאשר אין עיבוד */}\r\n            {!isProcessing && projects.length > 0 && (\r\n              <div className=\"space-y-6\">\r\n                <h3 className=\"text-xl font-semibold text-center\">פרויקטים קיימים</h3>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                  {projects.map((project) => (\r\n                    <ProjectCard\r\n                      key={project.id}\r\n                      project={project}\r\n                      onSelect={() => loadProject(project.id)}\r\n                      onDelete={() => handleDeleteProject(project.id)}\r\n                    />\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          // Studio View\r\n          <div className=\"space-y-8\">\r\n            {console.log('🔄 מציג מסך סטודיו - currentView:', currentView)}\r\n            {/* Studio Header */}\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <h2 className=\"text-2xl font-bold\">סטודיו אודיו</h2>\r\n                {selectedProject && (\r\n                  <p className=\"text-gray-400\">פרויקט: {selectedProject.name}</p>\r\n                )}\r\n              </div>\r\n              \r\n              <button\r\n                onClick={resetToUpload}\r\n                className=\"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors\"\r\n              >\r\n                פרויקט חדש\r\n              </button>\r\n            </div>\r\n\r\n            {/* Audio Tracks */}\r\n            {Object.keys(audioFiles).length > 0 ? (\r\n              <div className=\"space-y-6\">\r\n                {Object.entries(audioFiles).map(([trackId, trackData]) => (\r\n                  <TrackChannel\r\n                    key={trackId}\r\n                    trackId={trackId}\r\n                    trackData={trackData}\r\n                    isPlaying={playingTrack === trackId}\r\n                    volume={volumeLevels[trackId] || 1.0}\r\n                    isMuted={mutedTracks[trackId] || false}\r\n                    onPlay={() => playTrack(trackId)}\r\n                    onVolumeChange={(volume) => setTrackVolume(trackId, volume)}\r\n                    onMuteToggle={() => toggleTrackMute(trackId)}\r\n                    onDownload={() => handleDownloadStem(selectedProject.id, trackId)}\r\n                  />\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              // הצג EmptyState רק כאשר אין ערוצי אודיו ואין עיבוד פעיל\r\n              !isProcessing ? (\r\n                <EmptyState />\r\n              ) : (\r\n                // הצג מסך התקדמות כאשר יש עיבוד פעיל\r\n                <div className=\"max-w-2xl mx-auto\">\r\n                  <ProcessingStatus\r\n                    step={processingStep}\r\n                    progress={progress}\r\n                    error={error}\r\n                    fileName={uploadedFile?.name || selectedFile?.name}\r\n                    onCancel={cancelProcessing}\r\n                    onRetry={selectedProject && selectedProject.id ? \r\n                      () => retrySpecificProject(selectedProject.id) : \r\n                      retryProcessing\r\n                    }\r\n                  />\r\n                </div>\r\n              )\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AudioSeparation; "],"names":["getApiBaseUrl","viteEnv","replace","apiCall","_0","_1","__async","endpoint","options","url","console","log","method","headers","body","startTime","performance","now","response","fetch","__spreadProps","__spreadValues","responseTime","toFixed","status","statusText","Object","fromEntries","entries","ok","error","errorText","text","Error","data","json","success","message","stack","name","getProjects","Array","isArray","length","TrackChannel","trackId","trackData","isPlaying","volume","isMuted","onPlay","onVolumeChange","onMuteToggle","onDownload","className","getTrackColor","children","jsxs","jsx","Mic","Music2","Volume1","Music3","Music","getTrackIcon","getTrackName","duration","Math","round","jsxRuntimeExports","onClick","Pause","Play","title","Download","VolumeX","Volume2","type","min","max","step","value","onChange","e","parseFloat","target","disabled","ProjectCard","project","onSelect","onDelete","color","bg","id","Trash2","stems","keys","getStemsCount","createdAt","Calendar","dateString","Date","toLocaleDateString","year","month","day","hour","minute","formatDate","Clock","map","stem","forEach","EmptyState","FileAudio","UploadZone","onFileSelect","onDrop","isDragOver","setIsDragOver","useState","selectedFile","setSelectedFile","useRef","handleDragOver","preventDefault","files","from","dataTransfer","f","size","file","onDragOver","onDragEnter","onDragLeave","_a","document","getElementById","click","accept","Upload","bytes","i","floor","result","pow","formatFileSize","ProcessingStatus","progress","fileName","onRetry","onCancel","elapsedTime","setElapsedTime","estimatedTime","setEstimatedTime","useEffect","interval","setInterval","prev","clearInterval","totalEstimated","remaining","formatTime","seconds","minutes","remainingSeconds","toString","padStart","getStepColor","handleRetry","Split","Eye","CheckCircle","XCircle","Circle","getStepIcon","getStepText","getStepDescription","X","style","width","AlertCircle","RefreshCw","Zap","AudioSeparation","uploadedFile","setUploadedFile","projectName","setProjectName","isProcessing","setIsProcessing","setProgress","projects","setProjects","selectedProject","setSelectedProject","audioFiles","setAudioFiles","playingTrack","setPlayingTrack","audioElements","setAudioElements","currentTime","setCurrentTime","setDuration","volumeLevels","setVolumeLevels","mutedTracks","setMutedTracks","currentView","setCurrentView","showUploadForm","setShowUploadForm","processingStep","setProcessingStep","serverConnected","setServerConnected","setError","globalError","setGlobalError","pollingInterval","setPollingInterval","uploadController","setUploadController","serverStatus","setServerStatus","audioContextRef","current","window","AudioContext","webkitAudioContext","close","checkProjectStatusAdvanced","projectId","fileId","p","loadProject","loadError","savedProject","JSON","parse","localStorage","getItem","find","handleDeleteProject","filter","updatedProjects","setItem","stringify","handleFileUpload","includes","alert","retryProcessing","isReady","warn","reason","setTimeout","cancelProcessing","abort","handleDownloadStem","stemType","stemName","blob","downloadStem","link","createElement","href","download","appendChild","removeChild","errorMessage","stopAllTracks","values","audio","pause","resetToUpload","retryConnection","checkExistingProjects","savedProjects","healthCheck","checkServerConnection","toISOString","serverProjects","Wifi","WifiOff","retrySpecificProject","Audio","muted","addEventListener","play","playTrack","setTrackVolume","toggleTrackMute"],"mappings":"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"}